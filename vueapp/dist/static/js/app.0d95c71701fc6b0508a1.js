webpackJsonp([1],{CiIy:function(t,e){},K4gw:function(t,e){},KdJz:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),r=s("Xxa5"),o=s.n(r),i=s("exGp"),n=s.n(i),c={name:"App",data:function(){return{username:""}},watch:{$route:function(){this.reload()}},created:function(){this.reload(),this.$root.reload=this.reload},methods:{reload:function(){var t=n()(o.a.mark(function t(){var e=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.axios.get(this.$root.ApiServer+"/user",{withCredentials:!0}).then(function(t){e.username=t.data.user,e.$root.token=t.data.token}).catch(function(t){console.error(t)});case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("header",[t._m(0),t._v(" "),null!=t.username?s("div",{attrs:{id:"helloMsg"}},[s("p",{staticClass:"my-0"},[t._v("こんにちは "+t._s(t.username)+" さん！")]),t._v(" "),s("p",{staticClass:"py-0 my-0"},[s("router-link",{attrs:{to:"/logout"}},[t._v("ログアウト")])],1)]):t._e()]),t._v(" "),s("router-view")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-center"},[e("h1",[this._v("Share ToDo")])])}]};var d=s("VU/8")(c,l,!1,function(t){s("KdJz")},null,null).exports,u=s("/ocq"),h=s("BO1k"),p=s.n(h),m=s("8WSt"),v=(s("K4gw"),s("pMXA")),f={data:function(){return{config:{locale:v.Japanese,dateFormat:"Y-m-d H:i",enableTime:!0},expanded:!1,userList:"",user:null,todoList:null,selectPlaceholder:"共有",todo:"",datetime:"",checkedUser:[],todoListIsNull:!1}},components:{flatPickr:m.a},created:function(){var t=this;this.reloadTodoList(),this.axios.get(this.$root.ApiServer+"/userList",{}).then(function(e){t.userList=e.data.userList}).catch(function(t){console.error(t)})},methods:{rotation:function(){var t=document.getElementById("reloadBtn"),e=t.getElementsByTagName("div")[0];t.disabled=!0,e.classList.add("rotateAnime");var s=0;setInterval(function(){500===++s&&(clearInterval(),t.disabled=!1,e.classList.remove("rotateAnime"))})},reloadTodoList:function(t){var e=this;this.axios.get(this.$root.ApiServer+"/todoList",{withCredentials:!0}).then(function(t){e.user=t.data.user,e.todoList=t.data.todoList,null==t.data.user&&(e.$router.push("/login"),location.reload()),e.todoListIsNull=null===e.todoList}).catch(function(t){console.error(t),e.$router.push("/login"),location.reload()})},updatePlaceholder:function(){if(0===this.checkedUser.length)this.selectPlaceholder="共有";else{this.selectPlaceholder="";var t=!0,e=!1,s=void 0;try{for(var a,r=p()(this.checkedUser);!(t=(a=r.next()).done);t=!0){var o=a.value;this.selectPlaceholder+=o+", "}}catch(t){e=!0,s=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw s}}}},registerTodo:function(){var t=this;this.axios.defaults.headers.common={"X-CSRF-TOKEN":this.$root.token};var e=new URLSearchParams;e.append("todo",this.todo),e.append("date",document.getElementById("datetime-flatpickr").value),0!==this.checkedUser.length&&this.checkedUser.forEach(function(t){return e.append("shareUsers",t)}),this.axios.post(this.$root.ApiServer+"/registerTodo",e,{withCredentials:!0}).then(function(e){e.data.success?(t.todo="",t.datetime="",t.checkedUser=[],t.reloadTodoList(),t.updatePlaceholder(),t.popUpModal(),document.getElementById("datetime-flatpickr").value="","value"in document.getElementsByClassName("flatpickr-mobile")&&(document.getElementsByClassName("flatpickr-mobile")[0].value="")):console.err("failed")}).catch(function(t){console.error(t)})},doneTodo:function(t){var e=this;this.axios.defaults.headers.common={"X-CSRF-TOKEN":this.$root.token};var s=new URLSearchParams;s.append("todoId",t),this.axios.patch(this.$root.ApiServer+"/doneTodo",s,{withCredentials:!0}).then(function(t){t.data.success?e.reloadTodoList():console.err("failed")}).catch(function(t){console.error(t)})},deleteTodo:function(t){var e=this;this.axios.defaults.headers.common={"X-CSRF-TOKEN":this.$root.token};var s=new URLSearchParams;s.append("todoId",t),this.axios.delete(this.$root.ApiServer+"/deleteTodo?"+s.toString(),{withCredentials:!0}).then(function(t){t.data.success?e.reloadTodoList():console.err("failed")}).catch(function(t){console.error(t)})},popUpModal:function(){document.getElementById("trigger").checked=!document.getElementById("trigger").checked}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mx-auto py-3",attrs:{id:"todoForm"}},[s("div",{staticClass:"mx-4 text-center",attrs:{id:"todoList"}},[s("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",id:"reloadBtn"},on:{click:function(e){t.reloadTodoList(),t.rotation()}}},[t._m(0)]),t._v(" "),t._l(t.todoList,function(e){return s("div",{key:e.todoId,staticClass:"card my-2"},[s("div",{staticClass:"card-body"},[s("h5",{staticClass:"card-title"},[t._v(t._s(e.todoContent))]),t._v(" "),s("p",{staticClass:"card-text text-muted"},[t._v(t._s(e.todoDate))]),t._v(" "),t._l(e.shareUsers,function(e){return s("p",{key:e.user,staticClass:"card-text d-inline mx-2"},[e.doneFlag?s("span",{staticClass:"text-success"},[s("i",{staticClass:"bi bi-check-square"}),t._v("\n            "+t._s(e.user)+"\n          ")]):s("span",{staticClass:"text-danger"},[s("i",{staticClass:"bi bi-square"}),t._v("\n            "+t._s(e.user)+"\n          ")])])}),t._v(" "),s("div",[e.doneFlag?t._e():s("button",{staticClass:"btn btn-success col-auto mx-2",on:{click:function(s){return t.doneTodo(e.todoId)}}},[s("i",{staticClass:"bi bi-check-lg"})]),t._v(" "),e.createdUser==t.user?s("button",{staticClass:"btn btn-danger col-auto mx-2 deleteBtn",on:{click:function(s){return t.deleteTodo(e.todoId)}}},[s("i",{staticClass:"bi bi-trash"})]):t._e()])],2)])}),t._v(" "),t.todoListIsNull?s("h4",{staticClass:"my-5"},[t._v("やるべき事はありません")]):t._e()],2),t._v(" "),s("button",{staticClass:"btn btn-success col-auto mx-3 mb-3 modalButton",on:{click:function(e){return t.popUpModal()}}},[s("i",{staticClass:"bi bi-plus-lg"})]),t._v(" "),s("div",{staticClass:"modal_wrap"},[s("input",{staticStyle:{display:"none"},attrs:{id:"trigger",type:"checkbox"}}),t._v(" "),s("div",{staticClass:"modal_overlay"},[s("label",{staticClass:"modal_trigger",attrs:{for:"trigger"}}),t._v(" "),s("div",{staticClass:"modal_content my-auto py-3"},[t._m(1),t._v(" "),s("form",{staticClass:"py-5 px-3",attrs:{id:"newTodo"},on:{submit:function(e){return e.preventDefault(),t.registerTodo.apply(null,arguments)}}},[s("div",{staticClass:"py-1"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.todo,expression:"todo"}],staticClass:"form-control",attrs:{type:"text",placeholder:"やること",autofocus:"",required:""},domProps:{value:t.todo},on:{input:function(e){e.target.composing||(t.todo=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"py-1"},[s("flat-pickr",{staticClass:"form-control",attrs:{id:"datetime-flatpickr",modelValue:t.datetime,config:t.config,placeholder:"いつまで"}})],1),t._v(" "),s("div",{staticClass:"py-1 mb-3"},[s("div",{staticClass:"multiselect"},[s("div",{staticClass:"selectBox"},[s("input",{staticClass:"form-control",attrs:{type:"text",placeholder:t.selectPlaceholder,disabled:""}})]),t._v(" "),s("div",{staticClass:"text-start",attrs:{id:"checkboxes"}},t._l(t.userList,function(e){return s("div",{key:e.id},[e.id!=t.user?s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedUser,expression:"checkedUser"}],attrs:{id:e.id,type:"checkbox"},domProps:{value:e.id,checked:Array.isArray(t.checkedUser)?t._i(t.checkedUser,e.id)>-1:t.checkedUser},on:{change:[function(s){var a=t.checkedUser,r=s.target,o=!!r.checked;if(Array.isArray(a)){var i=e.id,n=t._i(a,i);r.checked?n<0&&(t.checkedUser=a.concat([i])):n>-1&&(t.checkedUser=a.slice(0,n).concat(a.slice(n+1)))}else t.checkedUser=o},t.updatePlaceholder]}}),t._v(" "),s("label",{attrs:{for:e.id}},[t._v(t._s(e.id))])]):t._e()])}),0)])]),t._v(" "),t._m(2)])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("i",{staticClass:"bi bi-arrow-clockwise align-middle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"close_button",attrs:{for:"trigger"}},[e("i",{staticClass:"bi bi-x"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-success col-auto mx-3 mb-3",attrs:{type:"submit"}},[e("i",{staticClass:"bi bi-pen"})])}]};var _=s("VU/8")(f,g,!1,function(t){s("TWJF")},null,null).exports,k={data:function(){return{path:"",submit:"",result:!1,link:"",link_str:"",message:"",error_message:"",id:"",password:""}},watch:{$route:function(){this.reload()}},mounted:function(){this.reload()},methods:{reload:function(){var t=n()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.path=this.$route.path,this.message="",this.error_message="","/login"!==this.path){t.next=9;break}this.submit="ログイン",this.link="/register",this.link_str="新規会員登録",t.next=19;break;case 9:if("/register"!==this.path){t.next=15;break}this.submit="登録",this.link="/login",this.link_str="ログイン",t.next=19;break;case 15:return this.link="/login",this.link_str="ログイン",t.next=19,this.exec();case 19:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),exec:function(){var t=n()(o.a.mark(function t(){var e,s,a=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$root.reload();case 2:e="",e="/logout"===this.path?"/login":this.path,this.axios.defaults.headers.common={"X-CSRF-TOKEN":this.$root.token},(s=new URLSearchParams).append("id",this.id),s.append("password",this.password),this.axios.post(this.$root.ApiServer+e,s,{withCredentials:!0}).then(function(t){if(t.data.success){switch(a.path){case"/login":a.message="認証に成功しました",a.$router.push("/");break;case"/register":a.message="登録が完了しました",a.result=!0}a.error_message=""}else switch(a.path){case"/login":a.message="",a.error_message="ユーザー名もしくはパスワードが違います";break;case"/logout":a.message="ログアウトしました",a.error_message="",a.$root.reload();break;case"/register":a.message="",a.error_message="同じユーザー名が存在しています"}}).catch(function(t){console.log(t),a.message="",a.error_message="接続に失敗しました"});case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},["/login"==t.path?s("h2",[t._v("ログイン")]):"/logout"==t.path?s("h2",[t._v("ログアウト")]):"/register"==t.path?s("h2",[t._v("新規会員登録")]):t._e(),t._v(" "),s("div",{staticClass:"mx-auto text-center"},["/logout"==t.path||t.result?t._e():s("div",[s("form",{on:{submit:function(e){return e.preventDefault(),t.exec.apply(null,arguments)}}},[s("div",{staticClass:"form-group"},[s("p",[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.id,expression:"id"}],staticClass:"form-control",attrs:{type:"text",name:"id",placeholder:"ID",required:"",autofocus:""},domProps:{value:t.id},on:{input:function(e){e.target.composing||(t.id=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"form-group"},[s("p",[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",name:"password",placeholder:"パスワード",required:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"form-group"},[s("p",[s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v(t._s(t.submit))])])])])]),t._v(" "),s("p",[s("router-link",{attrs:{to:t.link}},[t._v(t._s(t.link_str))])],1),t._v(" "),s("p",{staticClass:"text-danger"},[t._v(t._s(t.error_message))]),t._v(" "),s("p",{staticClass:"text-success"},[t._v(t._s(t.message))])])])},staticRenderFns:[]},C=s("VU/8")(k,b,!1,null,null,null).exports;a.a.use(u.a);var x=new u.a({routes:[{path:"/",component:_},{path:"/login",component:C},{path:"/register",component:C},{path:"/logout",component:C}]}),y=(s("CiIy"),s("mtWM")),w=s("aLYK");a.a.use(w.a,y.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:x,components:{App:d},template:"<App/>",data:function(){return{ApiServer:"http://localhost:8888"}},methods:{getCSRFToken:function(){var t=this;this.axios.get(this.$root.ApiServer+"/user",{withCredentials:!0}).then(function(e){return t.token=e.data.token,t.token}).catch(function(t){console.error(t)})}}})},TWJF:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.0d95c71701fc6b0508a1.js.map